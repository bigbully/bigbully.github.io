---
layout: post
title: 函数式编程scala第二章
description: 
category: scala
---

Getting started
===

2.1介绍
---
既然我们已经承诺使用纯函数，一个问题自然就来了：我们如何编写，即使是最简单的程序呢？大多数人都习惯于将程序作为一系列的命令，按顺序执行，每一个命令都带来响应的影响。在这一章中我们将学习如何在Scala语言写由纯函数组成的程序。

本章的主要目的是为那些scala初学者，或是函数式编程的初学者，或是两者皆为初学。如同学习外语，沉浸是一种非常有效的方法，所以我们会先看一个小而全的Scala程序。如果你有Scala没有经验，你别期待一看就能看懂代码。因此，我们整个程序分解为多个部分，来看看它是什么。

我们会看到如何使用高阶函数。这些函数是以其他函数作为参数，并且可能把一个函数作为其返回值。如果你写过很多代码，使用的语言并不能把函数当做参数或是返回值，那这个问题可能很难以理解（brain-bending）。记住，这不是关键，即便不管它，你也可以把本章讲的每一个概念记在心里，或是解决每一道习题。事实上，你可能会发现，现在先跳过整个部分，当你有更多经验之后再回来看，会变得更简单。

2.2一个scala的程序
----
下面是一个完整的scala程序。

	￼// A comment!
	/* Another comment */
	/** A documentation comment */
	object MyModule {
	  def abs(n: Int): Int =
	    if (n < 0) -n
	    else n
	  private def formatAbs(x: Int) = {
	    val msg = "The absolute value of %d is %d"
	    msg.format(x, abs(x))
	  }
	  def main(args: Array[String]): Unit =
	    println(formatAbs(-42))
	  }

我们声明了一个对象（也被称为“模块”）命名的myModule。这是简单地给我们的一个放代码的地方，和一个供我们引用的名字。关键词object创建一个新的单例类型，即myModule是这种类型唯一的值（或"居民"）。我们把代码放在对象内部的大括号中。我们将讨论对象，模块，和命名空间的更多的细节。现在，让我们来看看这个特定的对象。

myModule对象有三个方法：abs，formatAbs，main。每一种方法是通过def关键字定义，跟着方法的名称，以及括号内的参数。在这种情况下，所有三种方法只接收一个参数。如果有更多的参数，它们会用逗号隔开。接着参数列表的右括号之后，有一个可选的返回值类型声明。

方法体在置于等号（=）之后。我们有时会提到一个方法声明的部分，即在等号之前的部分，称之为左端（left-hand side）或方法签名（signature），以及在等号之后的部分，我们有时会称之为右端（right-hand side）或方法定义（definition）。注意没有一个明确的return关键字。一个方法的返回值是就是方法右端的值。

现在我们一个一个过这些方法。方法abs表示一个纯函数，它接收一个整数，并返回它的绝对值 ：[^footnote1]

 [^footnote1]:聪明的读者可能会注意到，这个方法定义并不适用于Integer.minvalue，即最小的负32位的整数，它没有相应的正整数。在这我们会忽略这个细节。

	def abs(n: Int): Int = //1
		if (n < 0) -n
		else n //2

 1. 方法abs接收一个Int类型参数，这里使用 n : Int 来声明
 2. 函数定义是一个scala表达式：使用内置的if语法，当n小于0时返回-n

formatAbs方法表示另一个纯函数：

	private def formatAbs(x: Int) = {
	  val msg = "The absolute value of %d is %d."
	  msg.format(x, abs(x)) //1
	}

 1. 这个String的format方法来自标准库。我们在msg对象中调用这个方法，传入x和abs(x)。结果返回一个新的String，把%d出现的地方依次使用x和abs(x)替换。你可以在下面的工具栏中看到对于String补充的说明。

该方法声明为私有的，这意味着它不能从MyModlure这个对象外被调用。这个函数接受一个Int类型返回一个String类型，但请注意返回值类型并没有声明。Scala通常可以推断出方法的返回类型，所以他们可以省略，但如果你希望别人使用你定义的这个方法，那么声明方法的返回类型会更好。这种方法是私有的，所以我们可以省略这种类型注释。

该方法体包含多条语句，所以我们把它们放在大括号内。一对大括号内的语句我们称之为*代码块*。新的一行或是被分号分隔被认为是一条语句。上文使用的是新的一行来分隔我们的语句。

块中第一条语句使用val关键字声明了一个String类型。val是不可变的变量，所以formatAbs方法体内的msg总是指向同一个String的值。如果你尝试给msg在同一个上下文中重新赋值，Scala编译器将会发出抱怨。

记住，一个方法只是简单地返回它右端代码块中的值。一个在大括号中的多语句的代码块的值等于最后一条语句的值。所以，formatAbs方法的结果就是msg.format(x, abs(x))的值。

>工具栏：String在scala中的补充
>我们可以使用String补充方法（[文档](http://docs.scala-lang.org/overviews/core/string-interpolation.html)）编写我们的formatAbs函数，而不是使用String的format方法。补充了的String可以引用上下文中声明了的值。一个声明了的String对象有个在第一个双引号之前需要加s，比如s"the absolute value of $x is ${abs(x)}" 。你可以通过上面的链接在文档中查看详细信息。

